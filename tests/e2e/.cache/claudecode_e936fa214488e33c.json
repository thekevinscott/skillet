{"prompt": "Write a commit message for this diff:\n\nFrom f31d564ff26532151b6e45f2be163ceea247a440 Mon Sep 17 00:00:00 2001\nFrom: Alex Ball <alex-ball@users.noreply.github.com>\nDate: Sun, 10 Oct 2021 16:42:07 +0100\nSubject: [PATCH] click.confirm preserves prompt when readline is imported\n\nsame fix as for click.prompt in 8.0.0\n---\n CHANGES.rst         | 2 ++\n src/click/termui.py | 6 ++++--\n tests/test_utils.py | 4 ++--\n 3 files changed, 8 insertions(+), 4 deletions(-)\n\ndiff --git a/CHANGES.rst b/CHANGES.rst\nindex c52c16007..e6e8e9bf3 100644\n--- a/CHANGES.rst\n+++ b/CHANGES.rst\n@@ -7,6 +7,8 @@ Unreleased\n \n -   Fix issue with ``Path(resolve_path=True)`` type creating invalid\n     paths. :issue:`2088`\n+-   Importing ``readline`` does not cause the ``confirm()`` prompt to\n+    disappear when pressing backspace. :issue:`2092`\n \n \n Version 8.0.2\ndiff --git a/src/click/termui.py b/src/click/termui.py\nindex a023f42bd..cf8d5f132 100644\n--- a/src/click/termui.py\n+++ b/src/click/termui.py\n@@ -231,8 +231,10 @@ def confirm(\n         try:\n             # Write the prompt separately so that we get nice\n             # coloring through colorama on Windows\n-            echo(prompt, nl=False, err=err)\n-            value = visible_prompt_func(\"\").lower().strip()\n+            echo(prompt.rstrip(\" \"), nl=False, err=err)\n+            # Echo a space to stdout to work around an issue where\n+            # readline causes backspace to clear the whole line.\n+            value = visible_prompt_func(\" \").lower().strip()\n         except (KeyboardInterrupt, EOFError):\n             raise Abort() from None\n         if value in (\"y\", \"yes\"):\ndiff --git a/tests/test_utils.py b/tests/test_utils.py\nindex d21b246c2..271177d2d 100644\n--- a/tests/test_utils.py\n+++ b/tests/test_utils.py\n@@ -275,8 +275,8 @@ def emulate_input(text):\n     emulate_input(\"y\\n\")\n     click.confirm(\"Prompt to stderr\", err=True)\n     out, err = capfd.readouterr()\n-    assert out == \"\"\n-    assert err == \"Prompt to stderr [y/N]: \"\n+    assert out == \" \"\n+    assert err == \"Prompt to stderr [y/N]:\"\n \n     monkeypatch.setattr(click.termui, \"isatty\", lambda x: True)\n     monkeypatch.setattr(click.termui, \"getchar\", lambda: \" \")\n", "text": "Here's a commit message for this diff:\n\n```\nFix confirm() prompt disappearing when readline is imported\n\nApply the same fix from click.prompt (8.0.0) to click.confirm: echo\nthe prompt without the trailing space, then pass a space to the input\nfunction. This prevents readline from clearing the entire prompt line\nwhen backspace is pressed.\n\nUpdate tests to expect the space on stdout and prompt without trailing\nspace on stderr.\n\nFixes #2092\n\n\ud83e\udd16 Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\n```", "session_id": "481f424e-17a1-4f50-80a3-8b140c470803"}